{% comment %}
  Renders a product card

  Accepts:
  - card_product: {Object} Product Liquid object (optional)
  - media_aspect_ratio: {String} Size of the product image card. Values are "square" and "portrait". Default is "square" (optional)
  - image_shape: {String} Image mask to apply to the product image card. Values are "arch", "blob", "chevronleft", "chevronright", "diamond", "parallelogram", and "round". (optional)
  - show_secondary_image: {Boolean} Show the secondary image on hover. Default: false (optional)
  - show_vendor: {Boolean} Show the product vendor. Default: false
  - show_rating: {Boolean} Show the product rating. Default: false
  - extend_height: {Boolean} Card height extends to available container space. Default: true (optional)
  - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)
  - skip_styles: {Boolean} Don't include component styles. Useful when rendering multiple product cards in a loop. Default: false (optional)
  - quick_add: {Boolean} Show the quick add button.
  - section_id: {String} The ID of the section that contains this card.
  - horizontal_class: {Boolean} Add a card--horizontal class if set to true. Default: false (optional)
  - horizontal_quick_add: {Boolean} Changes the quick add button styles when set to true. Default: false (optional)
  - placeholder_image: {String} The placeholder image to use when no product exists. Default: 'product-apparel-2' (optional)

  Usage:
  {% render 'card-product', show_vendor: section.settings.show_vendor %}
{% endcomment %}
{%- unless skip_styles -%}
  {{ 'component-rating.css' | asset_url | stylesheet_tag }}
  {{ 'component-volume-pricing.css' | asset_url | stylesheet_tag }}

  {{ 'component-price.css' | asset_url | stylesheet_tag }}
  {{ 'quick-order-list.css' | asset_url | stylesheet_tag }}
  {{ 'quantity-popover.css' | asset_url | stylesheet_tag }}
{%- endunless -%}
{% assign variants = card_product.variants %}

{%- if card_product and card_product != empty -%}
  {%- liquid
    assign ratio = 1
    if card_product.featured_media and media_aspect_ratio == 'portrait'
      assign ratio = 0.8
    elsif card_product.featured_media and media_aspect_ratio == 'adapt'
      assign ratio = card_product.featured_media.aspect_ratio
    endif
    if ratio == 0 or ratio == null
      assign ratio = 1
    endif
  -%}
  <div class="card-wrapper product-card-wrapper underline-links-hover">
    {% comment %}
      {%- for tag in card_product.tags -%}
        {%- if tag contains 'bagde_' -%}
          {%- assign tag_split = tag | split: '_' -%}
          <div class="card_badge">{{ tag_split[1] }}</div>
        {%- endif -%}
      {%- endfor -%}
    {% endcomment %}

    {%- for collection in card_product.collections -%}
      {%- if collection.handle == 'the-holi-edit' -%}
        <div class="card_badge">Holi Sale</div>
      {%- endif -%}
    {%- endfor -%}

    <div
      class="
        card card--{{ settings.card_style }}
        {% if card_product.featured_media %} card--media{% else %} card--text{% endif %}
        {% if settings.card_style == 'card' %} color-{{ settings.card_color_scheme }} gradient{% endif %}
        {% if image_shape and image_shape != 'default' %} card--shape{% endif %}
        {% if extend_height %} card--extend-height{% endif %}
        {% if card_product.featured_media == nil and settings.card_style == 'card' %} ratio{% endif %}
        {% if horizontal_class %} card--horizontal{% endif %}
      "
      style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;"
    >
      <div
        class="card__inner {% if settings.card_style == 'standard' %}color-{{ settings.card_color_scheme }} gradient{% endif %}{% if card_product.featured_media or settings.card_style == 'standard' %} ratio{% endif %}"
        style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;"
      >
        {%- if card_product.featured_media -%}
          <div class="card__media{% if image_shape and image_shape != 'default' %} shape--{{ image_shape }} color-{{ settings.card_color_scheme }} gradient{% endif %}">
            <a href="{{ card_product.url }}">
              <div class="media media--transparent media--hover-effect">
                {% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
                <img
                  src="{{ card_product.featured_media | image_url }}"
                  srcset="{{ card_product.featured_media | image_url }} {{ card_product.featured_media.width }}w"
                  sizes="100vw"
                  alt="{{ card_product.featured_media.alt | escape }}"
                  class="product-card__main-image"
                  class="motion-reduce"
                  {% unless lazy_load == false %}
                    loading="lazy"
                  {% endunless %}
                  width="{{ card_product.featured_media.width }}"
                  height="{{ card_product.featured_media.height }}"
                >
                {% comment %}theme-check-enable ImgLazyLoading{% endcomment %}

                {%- if card_product.media[1] != null -%}
                  <img
                    src="{{ card_product.media[1] | image_url }}"
                    srcset="{{ card_product.media[1] | image_url }} {{ card_product.media[1].width }}w"
                    sizes="100vw"
                    alt="{{ card_product.media[1].alt | escape }}"
                    class="motion-reduce"
                    loading="lazy"
                    width="{{ card_product.media[1].width }}"
                    height="{{ card_product.media[1].height }}"
                  >
                {%- endif -%}
              </div>
            </a>
          </div>

          {% assign product_form_id = 'quick-add-' | append: section_id | append: card_product.id %}
          {% if quick_add == 'standard' %}
            <div class="quick-add no-js-hidden">
              {%- liquid
                assign qty_rules = false
                if card_product.selected_or_first_available_variant.quantity_rule.min > 1 or card_product.selected_or_first_available_variant.quantity_rule.max != null or card_product.selected_or_first_available_variant.quantity_rule.increment > 1
                  assign qty_rules = true
                endif
              -%}
              {%- if card_product.variants_count > 1 or qty_rules -%}
                <modal-opener data-modal="#QuickAdd-{{ card_product.id }}">
                  <button
                    id="{{ product_form_id }}-submit"
                    type="submit"
                    name="add"
                    class="quick-add__submit button button--full-width button--secondary{% if horizontal_quick_add %} card--horizontal__quick-add animate-arrow{% endif %}"
                    aria-haspopup="dialog"
                    aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                    data-product-url="{{ card_product.url }}"
                  >
                    <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M0.0683594 5.90234C0.0227865 5.98438 0 6.07096 0 6.16211C0 6.25326 0.0227865 6.33984 0.0683594 6.42188C0.0683594 6.42188 0.123047 6.52669 0.232422 6.73633C0.341797 6.93685 0.501302 7.19206 0.710938 7.50195C0.847656 7.69336 0.998047 7.90299 1.16211 8.13086C1.33529 8.34961 1.52669 8.57292 1.73633 8.80078C2.00065 9.08333 2.29232 9.36589 2.61133 9.64844C2.93945 9.93099 3.29492 10.1908 3.67773 10.4277C4.14258 10.7194 4.65299 10.9564 5.20898 11.1387C5.76497 11.321 6.36198 11.4121 7 11.4121C7.63802 11.4121 8.23503 11.321 8.79102 11.1387C9.34701 10.9564 9.85742 10.7194 10.3223 10.4277C10.7051 10.1908 11.056 9.93099 11.375 9.64844C11.7031 9.36589 11.9993 9.08333 12.2637 8.80078C12.4733 8.57292 12.6602 8.34961 12.8242 8.13086C12.9974 7.90299 13.1523 7.69336 13.2891 7.50195C13.4987 7.19206 13.6582 6.93685 13.7676 6.73633C13.877 6.52669 13.9316 6.42188 13.9316 6.42188C13.9772 6.34896 14 6.26693 14 6.17578C14 6.08464 13.9772 5.99349 13.9316 5.90234C13.9316 5.90234 13.877 5.80208 13.7676 5.60156C13.6582 5.39193 13.4987 5.13672 13.2891 4.83594C13.1523 4.64453 12.9974 4.43945 12.8242 4.2207C12.6602 3.99284 12.4733 3.76497 12.2637 3.53711C11.9993 3.25456 11.7031 2.97201 11.375 2.68945C11.056 2.4069 10.7051 2.14714 10.3223 1.91016C9.85742 1.61849 9.34701 1.38151 8.79102 1.19922C8.23503 1.00781 7.63802 0.912109 7 0.912109C6.36198 0.912109 5.76497 1.00781 5.20898 1.19922C4.65299 1.38151 4.14258 1.61849 3.67773 1.91016C3.29492 2.14714 2.93945 2.4069 2.61133 2.68945C2.29232 2.97201 2.00065 3.25456 1.73633 3.53711C1.52669 3.76497 1.33529 3.99284 1.16211 4.2207C0.998047 4.43945 0.847656 4.64453 0.710938 4.83594C0.501302 5.13672 0.341797 5.39193 0.232422 5.60156C0.123047 5.80208 0.0683594 5.90234 0.0683594 5.90234ZM1.24414 6.16211C1.29883 6.08008 1.35807 5.98438 1.42188 5.875C1.49479 5.75651 1.58138 5.62891 1.68164 5.49219C1.80013 5.31901 1.93685 5.13216 2.0918 4.93164C2.24674 4.73112 2.41536 4.5306 2.59766 4.33008C2.83464 4.06576 3.0944 3.81055 3.37695 3.56445C3.65951 3.31836 3.96484 3.09505 4.29297 2.89453C4.6849 2.64844 5.10417 2.45247 5.55078 2.30664C6.00651 2.16081 6.48958 2.08789 7 2.08789C7.51042 2.08789 7.98893 2.16081 8.43555 2.30664C8.89128 2.45247 9.3151 2.64844 9.70703 2.89453C10.0352 3.09505 10.3405 3.31836 10.623 3.56445C10.9056 3.81055 11.1654 4.06576 11.4023 4.33008C11.5846 4.5306 11.7533 4.73112 11.9082 4.93164C12.0632 5.13216 12.1999 5.31901 12.3184 5.49219C12.4186 5.62891 12.5007 5.75651 12.5645 5.875C12.6374 5.98438 12.7012 6.08008 12.7559 6.16211C12.7012 6.24414 12.6374 6.3444 12.5645 6.46289C12.5007 6.57227 12.4186 6.69987 12.3184 6.8457C12.1999 7.01888 12.0632 7.20573 11.9082 7.40625C11.7533 7.60677 11.5846 7.80729 11.4023 8.00781C11.1654 8.26302 10.9056 8.51367 10.623 8.75977C10.3405 9.00586 10.0352 9.23372 9.70703 9.44336C9.3151 9.68034 8.89128 9.8763 8.43555 10.0312C7.98893 10.1771 7.51042 10.25 7 10.25C6.48958 10.25 6.00651 10.1771 5.55078 10.0312C5.10417 9.8763 4.6849 9.68034 4.29297 9.44336C3.96484 9.23372 3.65951 9.00586 3.37695 8.75977C3.0944 8.51367 2.83464 8.26302 2.59766 8.00781C2.41536 7.80729 2.24674 7.60677 2.0918 7.40625C1.93685 7.20573 1.80013 7.01888 1.68164 6.8457C1.58138 6.69987 1.49479 6.57227 1.42188 6.46289C1.35807 6.3444 1.29883 6.24414 1.24414 6.16211ZM9.33789 6.16211C9.33789 5.8431 9.27409 5.54232 9.14648 5.25977C9.02799 4.97721 8.86393 4.73112 8.6543 4.52148C8.44466 4.31185 8.19401 4.14779 7.90234 4.0293C7.61979 3.90169 7.31901 3.83789 7 3.83789C6.68099 3.83789 6.37565 3.90169 6.08398 4.0293C5.80143 4.14779 5.55534 4.31185 5.3457 4.52148C5.13607 4.73112 4.96745 4.97721 4.83984 5.25977C4.72135 5.54232 4.66211 5.8431 4.66211 6.16211C4.66211 6.49023 4.72135 6.79557 4.83984 7.07812C4.96745 7.36068 5.13607 7.60677 5.3457 7.81641C5.55534 8.02604 5.80143 8.19466 6.08398 8.32227C6.37565 8.44076 6.68099 8.5 7 8.5C7.31901 8.5 7.61979 8.44076 7.90234 8.32227C8.19401 8.19466 8.44466 8.02604 8.6543 7.81641C8.86393 7.60677 9.02799 7.36068 9.14648 7.07812C9.27409 6.79557 9.33789 6.49023 9.33789 6.16211ZM8.16211 6.16211C8.16211 6.32617 8.13021 6.48112 8.06641 6.62695C8.01172 6.76367 7.92969 6.88672 7.82031 6.99609C7.72005 7.09635 7.59701 7.17839 7.45117 7.24219C7.31445 7.30599 7.16406 7.33789 7 7.33789C6.83594 7.33789 6.68099 7.30599 6.53516 7.24219C6.39844 7.17839 6.27995 7.09635 6.17969 6.99609C6.07031 6.88672 5.98372 6.76367 5.91992 6.62695C5.86523 6.48112 5.83789 6.32617 5.83789 6.16211C5.83789 6.00716 5.86523 5.86133 5.91992 5.72461C5.98372 5.57878 6.07031 5.45117 6.17969 5.3418C6.27995 5.23242 6.39844 5.15039 6.53516 5.0957C6.68099 5.0319 6.83594 5 7 5C7.16406 5 7.31445 5.0319 7.45117 5.0957C7.59701 5.15039 7.72005 5.23242 7.82031 5.3418C7.92969 5.45117 8.01172 5.57878 8.06641 5.72461C8.13021 5.86133 8.16211 6.00716 8.16211 6.16211Z" fill="#111111"></path>
                    </svg>
                    {%- if horizontal_quick_add -%}
                      <span class="icon-wrap">
                        {{- 'icon-arrow.svg' | inline_asset_content -}}
                      </span>
                    {%- endif -%}
                    {%- render 'loading-spinner' -%}
                  </button>
                </modal-opener>
                <quick-add-modal id="QuickAdd-{{ card_product.id }}" class="quick-add-modal">
                  <div
                    role="dialog"
                    aria-label="{{ 'products.product.choose_product_options' | t: product_name: card_product.title | escape }}"
                    aria-modal="true"
                    class="quick-add-modal__content global-settings-popup"
                    tabindex="-1"
                  >
                    <button
                      id="ModalClose-{{ card_product.id }}"
                      type="button"
                      class="quick-add-modal__toggle"
                      aria-label="{{ 'accessibility.close' | t }}"
                    >
                      {{- 'icon-close.svg' | inline_asset_content -}}
                    </button>
                    <div id="QuickAddInfo-{{ card_product.id }}" class="quick-add-modal__content-info"></div>
                  </div>
                </quick-add-modal>
              {%- else -%}
                {% comment %}
                  <product-form data-section-id="{{ section.id }}">
                    {%- form 'product',
                      card_product,
                      id: product_form_id,
                      class: 'form',
                      novalidate: 'novalidate',
                      data-type: 'add-to-cart-form'
                    -%}
                      <input
                        type="hidden"
                        name="id"
                        value="{{ card_product.selected_or_first_available_variant.id }}"
                        class="product-variant-id"
                        {% if card_product.selected_or_first_available_variant.available == false %}
                          disabled
                        {% endif %}
                      >
                      <button
                        id="{{ product_form_id }}-submit"
                        type="submit"
                        name="add"
                        class="quick-add__submit button button--full-width button--secondary{% if horizontal_quick_add %} card--horizontal__quick-add{% endif %}"
                        aria-haspopup="dialog"
                        aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                        aria-live="polite"
                        data-sold-out-message="true"
                        {% if card_product.selected_or_first_available_variant.available == false %}
                          disabled
                        {% endif %}
                      >
                        <span>
                          {%- if card_product.selected_or_first_available_variant.available -%}
                            {{ 'products.product.add_to_cart' | t }}
                          {%- else -%}
                            {{ 'products.product.sold_out' | t }}
                          {%- endif -%}
                        </span>
                        <span class="sold-out-message hidden">
                          {{ 'products.product.sold_out' | t }}
                        </span>
                        {%- if horizontal_quick_add -%}
                          <span class="icon-wrap">
                            {{- 'icon-plus.svg' | inline_asset_content -}}
                          </span>
                        {%- endif -%}
                        {%- render 'loading-spinner' -%}
                      </button>
                    {%- endform -%}
                  </product-form>
                {% endcomment %}
              {%- endif -%}
            </div>
          {% elsif quick_add == 'bulk' %}
            {% if card_product.variants_count == 1 %}
              <quick-add-bulk
                data-min="{{ card_product.selected_or_first_available_variant.quantity_rule.min }}"
                id="quick-add-bulk-{{ card_product.selected_or_first_available_variant.id }}-{{ section.id }}"
                class="quick-add-bulk"
                data-index="{{ card_product.selected_or_first_available_variant.id }}"
              >
                {% if card_product.selected_or_first_available_variant.available == false %}
                  <button
                    id="{{ product_form_id }}-submit"
                    type="submit"
                    name="add"
                    class="quick-add__submit button button--full-width button--secondary"
                    aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                    data-sold-out-message="true"
                    disabled
                  >
                    <span>{{ 'products.product.sold_out' | t }}</span>
                    <span class="sold-out-message hidden">
                      {{ 'products.product.sold_out' | t }}
                    </span>
                  </button>
                {% else %}
                  {% render 'quantity-input', variant: card_product.selected_or_first_available_variant, min: 0 %}
                {% endif %}
              </quick-add-bulk>
            {% else %}
              <div class="quick-add no-js-hidden">
                {%- liquid
                  assign product_form_id = 'quick-add-' | append: section_id | append: card_product.id
                  assign qty_rules = false
                  if card_product.selected_or_first_available_variant.quantity_rule.min > 1 or card_product.selected_or_first_available_variant.quantity_rule.max != null or card_product.selected_or_first_available_variant.quantity_rule.increment > 1
                    assign qty_rules = true
                  endif
                -%}
                <modal-opener
                  id="QuickBulk-{{ card_product.id }}-{{ section_id }}"
                  data-modal="#QuickAddBulk-{{ card_product.id }}-{{ section.id }}"
                >
                  <button
                    id="{{ product_form_id }}-submit"
                    type="submit"
                    name="add"
                    class="quick-add__submit button button--full-width button--secondary"
                    aria-haspopup="dialog"
                    aria-labelledby="{{ product_form_id }}-submit title-{{ section_id }}-{{ card_product.id }}"
                    data-product-url="{{ card_product.url }}"
                  >
                    {{ 'products.product.choose_options' | t }}
                    {%- render 'loading-spinner' -%}
                  </button>
                </modal-opener>
                <modal-dialog
                  id="QuickAddBulk-{{ card_product.id }}-{{ section_id }}"
                  class="quick-add-modal color-{{ section.settings.color_scheme }}"
                >
                  <div
                    role="dialog"
                    aria-label="{{ 'products.product.choose_product_options' | t: product_name: card_product.title | escape }}"
                    aria-modal="true"
                    class="quick-add-modal__content quick-add-modal__content--bulk global-settings-popup"
                    tabindex="-1"
                  >
                    <button
                      id="ModalClose-{{ card_product.id }}"
                      type="button"
                      class="quick-add-modal__toggle"
                      aria-label="{{ 'accessibility.close' | t }}"
                    >
                      {{- 'icon-close.svg' | inline_asset_content -}}
                    </button>
                    <div
                      id="QuickAddInfo-{{ card_product.id }}"
                      class="quick-add-modal__content-info quick-add-modal__content-info--bulk"
                    >
                      <div class="quick-add__content-info__media">
                        <div class="quick-add__info">
                          {%- if card_product.featured_media -%}
                            <div
                              class="quick-add__product-media"
                            >
                              <div class="quick-add__product-container global-media-settings">
                                {% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
                                <img
                                  src="{{ card_product.featured_media | image_url }}"
                                  srcset="{{ card_product.featured_media | image_url }} {{ card_product.featured_media.width }}w"
                                  sizes="100vw"
                                  alt="{{ card_product.featured_media.alt | escape }}"
                                  class="motion-reduce"
                                  {% unless lazy_load == false %}
                                    loading="lazy"
                                  {% endunless %}
                                  width="{{ card_product.featured_media.width }}"
                                  height="{{ card_product.featured_media.height }}"
                                >
                                {% comment %}theme-check-enable ImgLazyLoading{% endcomment %}
                              </div>
                            </div>
                          {%- endif -%}
                          <a
                            {% if card_product == blank %}
                              role="link" aria-disabled="true"
                            {% else %}
                              href="{{ card_product.url }}"
                            {% endif %}
                            class="link product__view-details animate-arrow small-hide medium-hide"
                          >
                            {{ 'products.product.view_full_details' | t -}}
                            {{- 'icon-arrow.svg' | inline_asset_content -}}
                          </a>
                        </div>
                        <div class="quick-add-modal__content-info--bulk-details large-up-hide">
                          <a href="{{ card_product.url }}" class="full-unstyled-link">
                            <h3>{{ card_product.title | escape }}</h3>
                          </a>
                          {% render 'price', product: card_product, price_class: '', show_compare_at_price: true %}
                          {%- if card_product.quantity_price_breaks_configured? -%}
                            <div class="card__information-volume-pricing-note">
                              <span class="caption">{{ 'products.product.volume_pricing.note' | t }}</span>
                            </div>
                          {%- endif -%}
                        </div>
                      </div>
                      <div>
                        <div class="quick-add-modal__content-info--bulk-details small-hide medium-hide">
                          <a href="{{ card_product.url }}" class="full-unstyled-link">
                            <h3 class="h2">
                              {{ card_product.title | escape }}
                            </h3>
                          </a>
                          {% render 'price', product: card_product, price_class: '', show_compare_at_price: true %}
                          {%- if card_product.quantity_price_breaks_configured? -%}
                            <div class="card__information-volume-pricing-note">
                              <span class="caption">{{ 'products.product.volume_pricing.note' | t }}</span>
                            </div>
                          {%- endif -%}
                        </div>
                        <bulk-modal
                          id="QuickBulkModal-{{ card_product.id }}-{{ section_id }}"
                          data-url="{{ card_product.url }}"
                          data-section-id="{{ section_id }}"
                          data-product-id="{{ card_product.id }}"
                        >
                        </bulk-modal>
                      </div>
                    </div>
                  </div>
                </modal-dialog>
              </div>
            {% endif %}
          {% endif %}
        {%- endif -%}
        {% comment %}
          <div class="card__content">
            <div class="card__information">
              <h3
                class="card__heading"
                {% if card_product.featured_media == null and settings.card_style == 'standard' %}
                  id="title-{{ section_id }}-{{ card_product.id }}"
                {% endif %}
              >
                <a
                  href="{{ card_product.url }}"
                  id="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }}"
                  class="full-unstyled-link"
                  aria-labelledby="StandardCardNoMediaLink-{{ section_id }}-{{ card_product.id }} NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
                >
                  {{ card_product.title | escape }}
                </a>
              </h3>
            </div>
            <div class="card__badge {{ settings.badge_position }}">
              {%- if card_product.available == false -%}
                <span
                  id="NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
                  class="badge badge--bottom-left color-{{ settings.sold_out_badge_color_scheme }}"
                >
                  {{- 'products.product.sold_out' | t -}}
                </span>
              {%- elsif card_product.compare_at_price > card_product.price and card_product.available -%}
                <span
                  id="NoMediaStandardBadge-{{ section_id }}-{{ card_product.id }}"
                  class="badge badge--bottom-left color-{{ settings.sale_badge_color_scheme }}"
                >
                  {{- 'products.product.on_sale' | t -}}
                </span>
              {%- endif -%}
            </div>
          </div>
        {% endcomment %}

        {%
          render 'product-variant-picker',
          product: card_product,
          block: block,
          product_form_id: card_product.id | append:'--' | append:index0 | append:'--jay',
          picker_type:'button',
          swatch_shape:'square',
          section_id: section_id
        %}
        <div
          data-ele="quick-add-icon"
          class="strch-quick-add"
          {% if card_product.has_only_default_variant %}
            data-product="only-default-variant"
            data-product-default-variant-id="{{ card_product.selected_or_first_available_variant.id }}"
          {% endif %}
        >
          <div class="quick-add-button-container">
            <span>
              <span class="strch-quick-add-icon">
                {{- 'icon-quick-add.svg' | inline_asset_content -}}
              </span>
            </span>
          </div>
        </div>
      </div>

      {% comment %}
        {% if variants.size > 1 %}
          <div class="variant-image-slider-container"> <button class="variant-arrow variant-arrow--left">‹</button> <div class="variant-image-slider"> {% for variant in variants %} <div class="variant-image-slide" data-variant-id="{{ variant.id }}" data-img-url="{% if variant.featured_image %}{{ variant.featured_image | img_url: '600x' }}{% else %}{{ card_product.featured_image | img_url: '600x' }}{% endif %}"> <a href="{{ card_product.url }}?variant={{ variant.id }}"> {% if variant.featured_image %} <img src="{{ variant.featured_image | img_url: '120x' }}" alt="{{ variant.title }}" width="auto" height="auto"> {% else %} <img src="{{ card_product.featured_image | img_url: '120x' }}" alt="{{ card_product.title }}" width="auto" height="auto"> {% endif %} </a> </div> {% endfor %} </div> <button class="variant-arrow variant-arrow--right">›</button> </div>
        {% endif %}
      {% endcomment %}
      {% comment %}
        {% if variants.size > 1 %}
          {%- assign color_option_index = nil -%}
          {% for opt in card_product.options_with_values %}
            {% if opt.name == 'Color' %}
              {% assign color_option_index = forloop.index0 %}
            {% endif %}
          {% endfor %}
          {% if color_option_index != nil %}
            <div class="variant-image-slider-container">
              <button class="variant-arrow variant-arrow--left">‹</button>
              <div class="variant-image-slider">
                {% assign seen_colors = '' %}
                {% for variant in variants %}
                  {% assign color_value = variant.options[color_option_index] %}
                  {% unless seen_colors contains color_value %}
                    {% assign seen_colors = seen_colors | append: color_value | append: ',' %}
                    <div class="variant-image-slide" data-variant-id="{{ variant.id }}" data-img-url="{% if variant.featured_image %}{{ variant.featured_image | img_url: '600x' }}{% else %}{{ card_product.featured_image | img_url: '600x' }}{% endif %}">
                      <a href="{{ card_product.url }}?variant={{ variant.id }}">
                        {% if variant.featured_image %}
                          <img src="{{ variant.featured_image | img_url: '120x' }}" alt="{{ color_value }}" width="auto" height="auto">
                        {% else %}
                          <img src="{{ card_product.featured_image | img_url: '120x' }}" alt="{{ color_value }}" width="auto" height="auto">
                        {% endif %}
                      </a>
                    </div>
                  {% endunless %}
                {% endfor %}
              </div>
              <button class="variant-arrow variant-arrow--right">›</button>
            </div>
          {% endif %}
        {% endif %}
      {% endcomment %}
      {% render 'color-swatches-group',
        product: card_product,
        location: 'product_card',
        media_aspect_ratio: media_aspect_ratio,
        image_shape: image_shape,
        show_secondary_image: show_secondary_image,
        show_vendor: show_vendor,
        show_rating: show_rating,
        quick_add: quick_add
      %}
      <div class="card__content">
        <div class="card__information">
          <a
            href="{{ card_product.url }}"
            id="CardLink-{{ section_id }}-{{ card_product.id }}"
            class="full-unstyled-link"
            aria-labelledby="CardLink-{{ section_id }}-{{ card_product.id }} Badge-{{ section_id }}-{{ card_product.id }}"
          >
            <h3
              class="card__heading{% if card_product.featured_media or settings.card_style == 'standard' %} h5{% endif %}"
              {% if card_product.featured_media or settings.card_style == 'card' %}
                id="title-{{ section_id }}-{{ card_product.id }}"
              {% endif %}
            >
              {{ card_product.title | escape }}
            </h3>
            <div class="card-information">
              {%- if show_vendor -%}
                <span class="visually-hidden">{{ 'accessibility.vendor' | t }}</span>
                <div class="caption-with-letter-spacing light">{{ card_product.vendor }}</div>
              {%- endif -%}

              <span class="caption-large light">{{ block.settings.description | escape }}</span>

              {%- if show_rating and card_product.metafields.reviews.rating.value != blank -%}
                {% liquid
                  assign rating_decimal = 0
                  assign decimal = card_product.metafields.reviews.rating.value.rating | modulo: 1
                  if decimal >= 0.3 and decimal <= 0.7
                    assign rating_decimal = 0.5
                  elsif decimal > 0.7
                    assign rating_decimal = 1
                  endif
                %}
                <div
                  class="rating"
                  role="img"
                  aria-label="{{ 'accessibility.star_reviews_info' | t: rating_value: card_product.metafields.reviews.rating.value, rating_max: card_product.metafields.reviews.rating.value.scale_max }}"
                >
                  <span
                    aria-hidden="true"
                    class="rating-star"
                    style="--rating: {{ card_product.metafields.reviews.rating.value.rating | floor }}; --rating-max: {{ card_product.metafields.reviews.rating.value.scale_max }}; --rating-decimal: {{ rating_decimal }};"
                  ></span>
                </div>
                <p class="rating-text caption">
                  <span aria-hidden="true">
                    {{- card_product.metafields.reviews.rating.value }} /
                    {{ card_product.metafields.reviews.rating.value.scale_max -}}
                  </span>
                </p>
                <p class="rating-count caption">
                  <span aria-hidden="true">({{ card_product.metafields.reviews.rating_count }})</span>
                  <span class="visually-hidden">
                    {{- card_product.metafields.reviews.rating_count }}
                    {{ 'accessibility.total_reviews' | t -}}
                  </span>
                </p>
              {%- endif -%}

              {% render 'price', product: card_product, price_class: '', show_compare_at_price: true %}
              {%- if card_product.quantity_price_breaks_configured? -%}
                {% if card_product.variants_count == 1 and quick_add == 'bulk' %}
                  {% liquid
                    assign quantity_rule = card_product.selected_or_first_available_variant.quantity_rule
                    assign has_qty_rules = false
                    if quantity_rule.increment > 1 or quantity_rule.min > 1 or quantity_rule.max != null
                      assign has_qty_rules = true
                    endif
                  %}
                  <quantity-popover>
                    <button class="card__information-volume-pricing-note card__information-volume-pricing-note--button card__information-volume-pricing-note--button-{{ settings.card_text_alignment }} quantity-popover__info-button--icon-only button button button--tertiary medium-hide small-hide">
                      <span class="caption">{{ 'products.product.volume_pricing.note' | t }}</span>
                    </button>
                    <button class="card__information-volume-pricing-note card__information-volume-pricing-note--button card__information-volume-pricing-note--button-{{ settings.card_text_alignment }} quantity-popover__info-button--icon-with-label button button--tertiary large-up-hide">
                      <span class="caption">{{ 'products.product.volume_pricing.note' | t }}</span>
                    </button>
                {% else %}
                  <div class="card__information-volume-pricing-note">
                    <span class="caption">{{ 'products.product.volume_pricing.note' | t }}</span>
                  </div>
                {% endif %}
                {% if card_product.variants_count == 1 and quick_add == 'bulk' %}
                  <div
                    class="global-settings-popup quantity-popover__info"
                    tabindex="-1"
                    hidden
                    id="quantity-popover-info-{{ card_product.selected_or_first_available_variant.id }}"
                  >
                    {%- if has_qty_rules -%}
                      <div class="quantity__rules caption no-js-hidden">
                        {%- if quantity_rule.increment > 1 -%}
                          <span class="divider">
                            {{- 'products.product.quantity.multiples_of' | t: quantity: quantity_rule.increment -}}
                          </span>
                        {%- endif -%}
                        {%- if quantity_rule.min > 1 -%}
                          <span class="divider">
                            {{- 'products.product.quantity.min_of' | t: quantity: quantity_rule.min -}}
                          </span>
                        {%- endif -%}
                        {%- if quantity_rule.max != null -%}
                          <span class="divider">
                            {{- 'products.product.quantity.max_of' | t: quantity: quantity_rule.max -}}
                          </span>
                        {%- endif -%}
                      </div>
                    {%- endif -%}
                    <button
                      class="button-close button button--tertiary large-up-hide"
                      type="button"
                      aria-label="{{ 'accessibility.close' | t }}"
                    >
                      {{- 'icon-close.svg' | inline_asset_content -}}
                    </button>
                    {%- if card_product.selected_or_first_available_variant.quantity_price_breaks.size > 0 -%}
                      <volume-pricing class="parent-display">
                        <ul class="list-unstyled">
                          <li>
                            <span>{{ card_product.selected_or_first_available_variant.quantity_rule.min }}+</span>
                            {%- assign price = card_product.selected_or_first_available_variant.price
                              | money_with_currency
                            -%}
                            <span>{{ 'sections.quick_order_list.each' | t: money: price }}</span>
                          </li>
                          {%- for price_break in card_product.selected_or_first_available_variant.quantity_price_breaks -%}
                            <li>
                              <span>
                                {{- price_break.minimum_quantity -}}
                                <span aria-hidden="true">+</span></span
                              >
                              {%- assign price = price_break.price | money_with_currency -%}
                              <span> {{ 'sections.quick_order_list.each' | t: money: price }}</span>
                            </li>
                          {%- endfor -%}
                        </ul>
                      </volume-pricing>
                    {%- endif -%}
                  </div>
                  </quantity-popover>
                {% endif %}
              {%- endif -%}
            </div>
          </a>
        </div>
        <div class="card__badge {{ settings.badge_position }}">
          {%- if card_product.available == false -%}
            <span
              id="Badge-{{ section_id }}-{{ card_product.id }}"
              class="badge badge--bottom-left color-{{ settings.sold_out_badge_color_scheme }}"
            >
              {{- 'products.product.sold_out' | t -}}
            </span>
          {%- elsif card_product.compare_at_price > card_product.price and card_product.available -%}
            <span
              id="Badge-{{ section_id }}-{{ card_product.id }}"
              class="badge badge--bottom-left color-{{ settings.sale_badge_color_scheme }}"
            >
              {{- 'products.product.on_sale' | t -}}
            </span>
          {%- endif -%}
        </div>
      </div>
    </div>
  </div>
{%- else -%}
  {%- liquid
    assign ratio = 1
    assign placeholder = true
    if media_aspect_ratio == 'portrait'
      assign ratio = 0.8
    endif
  -%}
  <div class="card-wrapper product-card-wrapper underline-links-hover">
    <div
      class="
        card card--{{ settings.card_style }}
        {% if extend_height %} card--extend-height{% endif %}
        {% if image_shape and image_shape != 'default' %} card--shape{% endif %}
        {% if settings.card_style == 'card' %} color-{{ settings.card_color_scheme }} gradient{% endif %}
      "
      style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;"
    >
      <div
        class="card__inner{% if settings.card_style == 'standard' %} color-{{ settings.card_color_scheme }} gradient{% endif %} ratio"
      >
        <div
          class="card__media {% if image_shape and image_shape != 'default' %} shape--{{ image_shape }} color-{{ settings.card_color_scheme }} gradient{% endif %}"
        >
          <div
            class="media media--transparent"
          >
            {%- if placeholder_image -%}
              {{ placeholder_image | placeholder_svg_tag: 'placeholder-svg' }}
            {%- else -%}
              {{ 'product-apparel-2' | placeholder_svg_tag: 'placeholder-svg' }}
            {% endif %}
          </div>
        </div>
      </div>
      <div class="card__content">
        <div class="card__information">
          <h3 class="card__heading card__heading--placeholder{% if settings.card_style == 'standard' %} h5{% endif %}">
            <a role="link" aria-disabled="true" class="full-unstyled-link">
              {{ 'onboarding.product_title' | t }}
            </a>
          </h3>
          <div class="card-information">
            {%- if show_vendor -%}
              <span class="visually-hidden">{{ 'accessibility.vendor' | t }}</span>
              <div class="caption-with-letter-spacing light">{{ 'products.product.vendor' | t }}</div>
            {%- endif -%}
            {% render 'price', placeholder: placeholder, show_compare_at_price: true %}
          </div>
        </div>
      </div>
    </div>
  </div>
{%- endif -%}
